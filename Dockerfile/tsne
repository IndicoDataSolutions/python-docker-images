FROM indicoio/numpy as numpy-base
FROM indicoio/scipy as scipy-base
FROM indicoio/alpine

COPY --from=numpy-base /root/.cache/pip/wheels/ /root/.cache/pip/wheels
COPY --from=scipy-base /root/.cache/pip/wheels/ /root/.cache/pip/wheels

RUN apk update && \
    apk add --no-cache openblas openblas-dev && \
    pip3 install cython numpy==1.15.4 && \
    pip3 wheel scipy==1.1.0 git+https://github.com/IndicoDataSolutions/tsne.git
